# 本リポジトリで使用した敵対生成手法の理論解説
本リポジトリでは，以下の3種類の敵対的摂動生成手法を実装・比較した．

## FGSM（Fast Gradient Sign Method）
- **目的** 単一の入力画像 $x$ に対して，正解ラベル$y$の分類精度を下げる．
- **定式化** :
$$
x^{\text{adv}} = x + \varepsilon \cdot \text{sign}(\nabla_x \mathcal{L}(f_\theta(x), y)) 
$$
- **特徴と式の直感的解釈**:
    - 入力に対する損失関数の勾配方向に摂動を加える 
    - わずかな摂動でモデルを効率よく騙すことができる
    - **高速・簡易**だが，入力ごとに再生成が必要
    - モデルの構造・勾配情報に強く依存

### FGSMに関する解説・考察・検討
#### 攻撃の効率性について
FGSMはモデルの入力に対する**損失関数の勾配方向に摂動を加える攻撃手法**である．  
モデルが最も敏感な勾配方向に摂動を加えるため，最も効率的に分類境界を超える摂動を与えることが可能となるため，わずかな摂動でモデルに誤分類させることが可能となる．これが，**FGSMの効率的な攻撃性能の源泉**となる．

#### 転移性・実用性について
一方で，この方法の課題としては**モデルごとの勾配情報に強く依存する**方法であるため，実運用モデルと攻撃者が持つモデルの勾配が大きく異なるとその転移性も制限を受ける点が課題となる.  
また，FGSMは各入力に対して**個別に敵対的な摂動を加える手法**であることにも留意する必要がある．現実の問題を考える時に，入力対象$x$がすでに判明していてかつ，攻撃者が事前に入力にアクセスできる状態は考えにくいため，**攻撃手法としての活用することは現実には困難**だと考えられる．  

#### FGSMの活用方法に関する検討
さて，FGSMを有効活用する手段としてはどのようなものがあるか検討する．  
最も有効的に活用する手段としては，データ拡張としての活用が考えられる．一般にデータ拡張は，訓練データが不足するときの補完手段として行われるが，FGSMの持つ「不安定な方向を炙り出す」性質を活用し，**モデルの頑健性向上**を図る用途での使用を考える．    
FGSMは損失関数の勾配方向に摂動を加えることで，効率よく敵対的な摂動を加える攻撃手段であった．
> FGSMで得られる摂動方向は，モデルが**推論不安定性を持つ方向**を明示すると考えられる．

そこで，このような方向へ摂動を加えたのサンプルを訓練データに加えることで**損失関数の勾配を平滑化**し，推論安定性を向上させる可能性が期待できる．
これにより，入力の変化に対するsoftmax出力の変動が小さくなるため，モデルの推論の安定性が高まると考えられる．  
具体的には，FGSM摂動付きサンプル$x^{\text{adv}}$を訓練データに追加し再学習を行う．これにより，モデルのsoftmax出力は摂動に対して鋭い変化をしなくなり，ロバスト性の向上が期待できる．

※注意点  
以上のデータ拡張には**類似データの重複学習**が生じ，特定のデータに対する過学習を助長するリスクが考えられる．  
対策としては
- 摂動付与データと元データの差し替え
- 摂動データによる低学習率でのチューニング
- FGSMを適用する前のデータを訓練データから分離する
などが考えられる．

## UAP（Universal Adversarial Perturbation）
- **目的** 全ての入力（$x \sim D$）に共通して適用可能な**汎用摂動**$\delta$を学習し，**多様な入力に対して誤分類を誘発すること**を目指す．

- **定式化**:
  $$
  \max_{\delta \in \mathcal{C}_\epsilon} \; \mathbb{E}_{(x, y) \sim D}[\mathcal{L}(f_\theta(x + \delta), y)]
  $$
  - $\mathcal{C}_\epsilon$：摂動の大きさを制限する集合

- **特徴**
    - 訓練データ全体に共通して通用する一つの摂動テンソルを最適化
    - 摂動テンソルは訓練データに対する損失関数を制約下で最大化することを目指す
    - 制約を厳しくすることで，視覚的な判断が困難な摂動テンソルが生成可能に
    - 一度学習すれば，新しい入力にも適用可能．
    - **タスクレベルの脆弱性**を突く構造

### UAPに関する解説・考察・検討
#### 汎用摂動の意味と直感
UAPは，ある一つの摂動テンソル$\delta$を通じて，**モデルそのものの脆弱性**を突くことを目的とした攻撃手法である．UAPは入力に依存せず，モデルが分類を誤るように全ての入力に同様の摂動を加えることで，汎用的な摂動テンソルを生成する．

#### 転移可能性について
本リポジトリにおいて，UAPは高い転移可能性を示した．特に`ResNet`に対する転移性能には目を見張るものがあり，小規模データから十分有効な敵対生成を行える可能性が示唆される．特定のモデルの損失の最大化を図っただけであるにも関わらず，構造が異なり，より豊富な訓練データを用いたモデルに対して有効性を示した点は，